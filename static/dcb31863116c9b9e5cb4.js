(self.webpackChunkcloud_onchain_trade_sdk=self.webpackChunkcloud_onchain_trade_sdk||[]).push([[225],{33801:(e,i,t)=>{"use strict";var n;t.d(i,{VH:()=>l}),e=t.hmd(e),(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var s,o,r="{{rootDomain}}",a="{{network}}";function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1?arguments[1]:void 0;return e?e.replace(a,i):e}(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(s.register(".","DOT","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js"),s.register(r,"ROOT_DOMAIN","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js"),s.register(a,"NETWORK","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js"),s.register((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=null!=i&&i.hostname?i.hostname:window.location.hostname,n=t.split(".");return n.length>2?n.slice(-e).join("."):t}),"getLevelDomain","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js"),s.register((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1?arguments[1]:void 0;return e?e.replace(r,i):e}),"replaceDomian","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js"),s.register(l,"replaceNetwork","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/getLevelDomain.js")),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&o(e)},69685:(e,i,t)=>{"use strict";t.d(i,{h:()=>a});var n=t(34221),s=t(24121),o=t(52983),r=t(25315);const a=()=>{const{selectedNetworkId:e}=(0,n.o6)(),i=(0,s.xx)({chainId:e});return(0,o.useMemo)((()=>r.yw[i]||{}),[i])}},88016:(e,i,t)=>{"use strict";t.d(i,{F:()=>C,K:()=>y});var n=t(50650),s=t(56231),o=t(68761),r=t(12466),a=t(64999),l=t(17921),c=t(52983),d=t(36988),u=t(25315),m=t(82526),p=t(31558),g=t(47569);const y={Close:1,CancelLimit:2,Open:3},v=({hash:e,onClose:i})=>{const{useHistoryDetail:t,getI18n:n}=(0,c.useContext)(g.C),{useHistoryDetailSymbol:o,useHistoryDetailType:r}=t(),{symbol:a,isLong:l,symbolName:d}=o(e),{i18n:u}=r(e);return(0,c.useMemo)((()=>c.createElement("div",{className:"flex items-center justify-between mb-4"},c.createElement("div",{className:"text-t-primary text-subtitle1"},d||a," ",l?n("orderForm-long","Long"):n("orderForm-short","Short")," -  ",u),c.createElement(s.E,{width:"20px",height:"20px",fontSize:"20px",className:"cursor-pointer absolute right-4 text-t-third",onClick:i}))),[n,u,l,i,a,d])},f=({hash:e})=>{const{getI18n:i,useHistoryDetail:t,staticHost:n}=(0,c.useContext)(g.C),{useHistoryDetailLeverage:s,useHistoryDetailSymbol:o,useHistoryDetailPNLROI:r}=t(),a=s(e),{symbolType:l}=o(e),{isPNLNegative:d,isPNLPositive:u}=r(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-leverage","Leverage")},c.createElement("div",{className:"flex items-center gap-1"},a,c.createElement(p.b,{staticHost:n,symbolType:l,isPNLNegative:d,isPNLPositive:u})))},h=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailInitialMargin:n}=t(),s=n(e),o=(0,c.useMemo)((()=>c.createElement("div",{className:"w-[282px]"},c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line"},i("userinfo-dialog-detail-history-initialMargin-tips01","Initial Margin is the margin initially allocated to this position.")),c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line mt-3"},i("userinfo-dialog-detail-history-initialMargin-tips02","Initial Margin = Principal - Open Fee")))),[i]);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-initialMargin","Initial Margin"),tips:o,showLabelSx:!0},s)},P=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailQtyAndSize:n,useHistoryDetailPair:s}=t(),{baseAsset:o}=s(e),{size:r,qty:a}=n(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-qty","QTY(Size)")},a," ",o," ( ≈ ",r," USD )")},b=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailPrice:n}=t(),{entryPrice:s}=n(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-entryPrice","Entry Price")},s," USD")},L=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailPrice:n}=t(),{closePrice:s}=n(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-closePrice","Close Price")},s," USD")},N=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailLiqLostRate:n}=t(),s=n(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-liquidLostRate","Liquid Lost Rate")},`${new l.Z(s).multipliedBy(100).toFixed(2)}%`)},E=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailFundingFee:n}=t(),{fundingFee:s,isFundingFeeNegative:o}=n(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-accFundingFee","Acc. Funding Fee")},c.createElement("div",{className:"text-subtitle2",style:{color:o?"var(--colors-t-sell)":"var(--colors-t-buy)"}},s))},O=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailPNLROI:n}=t(),{PNL:s,isPNLNegative:o}=n(e),r=(0,c.useMemo)((()=>c.createElement("div",{className:"w-[282px]"},c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line"},i("userinfo-dialog-detail-history-realizedPnl-tips01","Realized PNL only calculates the profit and loss generated after the position is successfully opened.")),c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line mt-3"},i("userinfo-dialog-detail-history-realizedPnl-tips02-v2","Long : Realized PNL = (Close Price - Entry Price) * Qty + Funding Fee")),c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line"},i("userinfo-dialog-detail-history-realizedPnl-tips03-v2","Short : Realized PNL = (Entry Price - Close Price ) * Qty + Funding Fee")))),[i]);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-realizedPnl","Realized PNL"),tips:r,showLabelSx:!0},c.createElement("div",{className:"text-subtitle2",style:{color:o?"var(--colors-t-sell)":"var(--colors-t-buy)"}},s))},w=({hash:e})=>{const{getI18n:i,useHistoryDetail:t,enableShare:n,ee:s}=(0,c.useContext)(g.C),{useHistoryDetailPNLROI:r}=t(),{ROI:a,isROINegative:l}=r(e),d=(0,c.useCallback)((()=>s.emit("MODAL_POSITION_SHARE_OPEN",{hash:e,overlay:!0})),[s,e]),u=(0,c.useMemo)((()=>c.createElement("div",{className:"w-[282px]"},c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line"},i("userinfo-dialog-detail-history-realizedROI-tips01","Realized ROI = Realized PNL / Initial margin * 100%")))),[i]);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-realizedROI","Realized ROI"),tips:u,showLabelSx:!0},c.createElement("div",{className:"text-subtitle2",style:{color:l?"var(--colors-t-sell)":"var(--colors-t-buy)"}},a),n&&c.createElement("div",null,c.createElement(o.f,{className:"relative ml-0.5 cursor-pointer text-t-third",width:"16px",height:"16px",fontSize:"16px",onClick:d})))},F=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailOpenCloseFee:n}=t(),{openFee:s}=n(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-openFee","Open Fee")},s)},M=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailOpenCloseFee:n}=t(),{closeFee:s,isDynamicClosingFee:o}=n(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-closeFee","Close Fee")},c.createElement("div",{className:"flex flex-col"},s,o?c.createElement("div",{className:"text-caption1 text-t-secondary text-right"},c.createElement(d.c,{i18nKey:"userinfo-close-fee-based-pnl",defaults:i("userinfo-close-fee-based-pnl","Charge based on PNL <viewMoreLink>View</viewMoreLink>"),components:{viewMoreLink:c.createElement("a",{href:u.WO,className:"text-t-link hover:text-t-linkHover",target:"_blank",rel:"noreferrer"})}})):null))},B=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailOpenCloseFee:n}=t(),{executionFee:s}=n(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-executionFee","Execution Fee")},s)},T=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailNetProfit:n}=t(),{netProfit:s,isNetProfitNegative:o}=n(e),r=(0,c.useMemo)((()=>c.createElement("div",{className:"w-[282px]"},c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line"},i("userinfo-dialog-detail-history-netProfit-tips01","Net Profit is the profit and loss obtained after taking into account the trader's principal and trading fees.")),c.createElement("div",{className:"text-t-white text-caption whitespace-pre-line mt-3"},i("userinfo-dialog-detail-history-netProfit-tips02","Net Profit = Realized PNL - Open Fee - Close Fee")))),[i]);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-netProfit","Net Profit"),tips:r,showLabelSx:!0},c.createElement("div",{className:"text-subtitle2",style:{color:o?"var(--colors-t-sell)":"var(--colors-t-buy)"}},s))},_=({hash:e})=>{const{getI18n:i,useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailDuration:n}=t(),{time:s}=n(e);return c.createElement(m.Z,{label:i("userinfo-dialog-detail-time","Time")},s)},D=({hash:e})=>c.createElement("div",{className:"flex flex-col gap-6 max-h-[80vh] overflow-auto lg:h-[unset] lg:overflow-hidden lg:flex-row"},c.createElement("div",{className:"flex flex-col w-full lg:w-1/2 gap-4"},c.createElement(f,{hash:e}),c.createElement(h,{hash:e}),c.createElement(P,{hash:e}),c.createElement(b,{hash:e}),c.createElement(L,{hash:e}),c.createElement(N,{hash:e}),c.createElement(E,{hash:e}),c.createElement(O,{hash:e}),c.createElement(w,{hash:e})),c.createElement("div",{className:"flex flex-col w-full lg:w-1/2 gap-4 bg-interactive-interactive01 dark:bg-interactive-interactive01 rounded-[10px] p-[16px] h-[max-content] "},c.createElement(F,{hash:e}),c.createElement(B,{hash:e}),c.createElement(M,{hash:e}),c.createElement(T,{hash:e}),c.createElement("div",{className:"border-b-[var(--colors-border-line)] border-b border-solid"}),c.createElement(_,{hash:e}))),S=({hash:e})=>c.createElement("div",{className:"flex flex-col overflow-auto gap-6 max-h-[80vh]  lg:h-[unset] lg:overflow-hidden lg:flex-row"},c.createElement("div",{className:"flex flex-col w-full lg:w-1/2 gap-4"},c.createElement(f,{hash:e}),c.createElement(h,{hash:e}),c.createElement(P,{hash:e}),c.createElement(b,{hash:e}),c.createElement(N,{hash:e})),c.createElement("div",{className:"flex flex-col w-full lg:w-1/2 gap-4 bg-interactive-interactive01 dark:bg-interactive-interactive01 rounded-[10px] p-[16px] h-[max-content] "},c.createElement(F,{hash:e}),c.createElement(B,{hash:e}),c.createElement(_,{hash:e}))),x=({hash:e})=>c.createElement("div",{className:"flex max-h-[80vh] overflow-auto lg:max-h-[unset lg:overflow-hidden"},c.createElement("div",{className:"flex flex-col w-full gap-4"},c.createElement(_,{hash:e}))),I=({hash:e,onClose:i})=>{const{useHistoryDetail:t}=(0,c.useContext)(g.C),{useHistoryDetailType:n}=t(),{type:s}=n(e);return s===y.CancelLimit?c.createElement("div",{className:"history-detail-content w-full sm:w-[368px]"},c.createElement(v,{hash:e,onClose:i}),c.createElement(x,{hash:e})):c.createElement("div",{className:"history-detail-content w-full sm:w-[718px]"},c.createElement(v,{hash:e,onClose:i}),s===y.Close&&c.createElement(D,{hash:e}),s===y.Open&&c.createElement(S,{hash:e}))},C=()=>{const{ee:e}=(0,c.useContext)(g.C),[i,t]=(0,c.useState)(""),{isMobile:s}=(0,n.F)(),o=(0,c.useCallback)((()=>{t("")}),[]),l=(0,c.useCallback)((({hash:e})=>{t(e)}),[]);return(0,c.useEffect)((()=>(e.on("MODAL_HISTORY_DETAIL_OPEN",l),e.on("MODAL_HISTORY_DETAIL_CLOSE",o),()=>{e.off("MODAL_HISTORY_DETAIL_OPEN",l),e.off("MODAL_HISTORY_DETAIL_CLOSE",o)})),[e,o,l]),s?c.createElement(r.yo,{open:Boolean(i)},c.createElement(r.ue,{side:"bottom",className:"w-full border-none p-4 pb-6 rounded-t-[4px] bg-interactive-interactiveBg z-tooltip",onPointerDownOutside:o},c.createElement(I,{hash:i,onClose:o}))):c.createElement(a.Vq,{open:Boolean(i)},c.createElement(a.PK,null,c.createElement(a.cZ,{className:"p-4",onPointerDownOutside:o},c.createElement(I,{hash:i,onClose:o}))))}},47569:(e,i,t)=>{"use strict";t.d(i,{C:()=>n});const n=t(52983).createContext({})},31558:(e,i,t)=>{"use strict";t.d(i,{b:()=>o});var n=t(1750),s=t(52983);const o=({symbolType:e,isPNLNegative:i,isPNLPositive:t,staticHost:o})=>{const r=(0,s.useMemo)((()=>i?`${o}/static/images/degen-mode/degen-negative-pnl.svg`:t?`${o}/static/images/degen-mode/degen-positive-pnl.svg`:`${o}/static/images/degen-mode/degen-neutral.svg`),[i,t,o]);return(0,n.L)(e).isDegenMode?s.createElement("img",{src:r,width:"20px",height:"20px"}):null}},82526:(e,i,t)=>{"use strict";t.d(i,{Z:()=>l});var n=t(18868),s=t(52983),o=t(17581);const r=({label:e,showLabelSx:i,tips:t})=>(0,s.useMemo)((()=>{const n=s.createElement("div",{className:"text-t-secondary text-subtitle2 border-dashed border-b sm:border-none",style:{borderBottomColor:i?"var(--colors-t-secondary)":"transparent"}},e);return t?s.createElement(s.Fragment,null,s.createElement("div",{className:"hidden sm:block"},s.createElement(o.c,{tip:t},n)),s.createElement("div",{className:"block sm:hidden"},s.createElement(o.x,{tip:t},n))):n}),[i,e,t]),a=e=>s.createElement("div",Object.assign({},e,{className:(0,n.cn)("flex items-center text-subtitle2 text-t-primary",e.className)})),l=({label:e,showLabelSx:i=!1,children:t,tips:n})=>(0,s.useMemo)((()=>s.createElement("div",{className:"flex items-top justify-between"},s.createElement(r,{tips:n,label:e,showLabelSx:i}),s.createElement(a,null,t))),[n,e,i,t])},17581:(e,i,t)=>{"use strict";t.d(i,{c:()=>a,x:()=>l});var n=t(88637),s=t(18868),o=t(48444),r=t(52983);const a=e=>{const{tip:i,children:t,tipClassName:o}=e;return r.createElement(n.u,null,r.createElement(n.NM,null,r.createElement(n._v,{side:"top",align:"start",className:"round-[4px] p-3 rounded max-w-[376px]"},r.createElement("div",{className:(0,s.cn)("flex item-center text-t-white text-caption whitespace-pre-line",o)},i),r.createElement(n.Ce,null))),r.createElement(n.aJ,{asChild:!0,className:"cursor-pointer"},t))},l=e=>{const{tip:i,children:t,tipClassName:n}=e;return r.createElement(o.J2,null,r.createElement(o.i9,null,r.createElement(o.yk,{side:"top",align:"start",className:"round-[4px] p-3 rounded"},r.createElement(o.QH,null),r.createElement("div",{className:(0,s.cn)("flex item-center text-t-white text-caption whitespace-pre-line",n)},i))),r.createElement(o.xo,{asChild:!0},t))}},42623:(e,i,t)=>{"use strict";t.d(i,{Tw:()=>o,pT:()=>s});const n=new Map([[56,{name:"BNB Chain",iconUrlPath:"/static/images/wallet/bsc-logo.svg",color:"#F0B90B",apiNetwork:"bnb"}],[97,{name:"BNB Testnet",iconUrlPath:"/static/images/wallet/bsc-logo.svg",color:"#F0B90B",apiNetwork:"bnb-testnet"}],[42161,{name:"Arbitrum",iconUrlPath:"/static/images/wallet/arb-logo.svg",color:"#28A0F0",apiNetwork:"arbitrum"}],[421613,{name:"Arbitrum Goerli",iconUrlPath:"/static/images/wallet/arb-logo.svg",color:"#28A0F0",apiNetwork:"arbitrum-goerli"}]]),s=e=>{if(e)return n.get(e)},o=(e,i)=>{var t,n,o;return null!==(o=null!==(n=null===(t=s(e))||void 0===t?void 0:t.name)&&void 0!==n?n:i)&&void 0!==o?o:""}},68761:(e,i,t)=>{"use strict";t.d(i,{f:()=>s});var n=t(52983);const s=e=>n.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",...e},n.createElement("path",{d:"M9 14.5A6.5 6.5 0 0115.5 8h1.672l-2.586 2.586L16 12l5-5-5-5-1.414 1.414L17.172 6H15.5A8.5 8.5 0 007 14.5V17h2v-2.5z",fill:"currentColor"}),n.createElement("path",{d:"M19 15h2v6H3v-6h2v4h14v-4z",fill:"currentColor"}))},89479:(e,i,t)=>{var n=1/0,s="[object Symbol]",o="\\ud800-\\udfff",r="\\u0300-\\u036f\\ufe20-\\ufe23",a="\\u20d0-\\u20f0",l="\\ufe0e\\ufe0f",c="["+o+"]",d="["+r+a+"]",u="\\ud83c[\\udffb-\\udfff]",m="[^"+o+"]",p="(?:\\ud83c[\\udde6-\\uddff]){2}",g="[\\ud800-\\udbff][\\udc00-\\udfff]",y="\\u200d",v="(?:"+d+"|"+u+")?",f="["+l+"]?",h=f+v+"(?:"+y+"(?:"+[m,p,g].join("|")+")"+f+v+")*",P="(?:"+[m+d+"?",d,p,g,c].join("|")+")",b=RegExp(u+"(?="+u+")|"+P+h,"g"),L=RegExp("["+y+o+r+a+l+"]"),N="object"==typeof t.g&&t.g&&t.g.Object===Object&&t.g,E="object"==typeof self&&self&&self.Object===Object&&self,O=N||E||Function("return this")();function w(e){return L.test(e)}var F=Object.prototype.toString,M=O.Symbol,B=M?M.prototype:void 0,T=B?B.toString:void 0;function _(e){return null==e?"":function(e){if("string"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&F.call(e)==s}(e))return T?T.call(e):"";var i=e+"";return"0"==i&&1/e==-n?"-0":i}(e)}var D=("toUpperCase",function(e){var i,t,n,s,o=w(e=_(e))?function(e){return w(e)?function(e){return e.match(b)||[]}(e):function(e){return e.split("")}(e)}(e):void 0,r=o?o[0]:e.charAt(0),a=o?(i=o,t=1,s=i.length,n=void 0===n?s:n,!t&&n>=s?i:function(e,i,t){var n=-1,s=e.length;i<0&&(i=-i>s?0:s+i),(t=t>s?s:t)<0&&(t+=s),s=i>t?0:t-i>>>0,i>>>=0;for(var o=Array(s);++n<s;)o[n]=e[n+i];return o}(i,t,n)).join(""):e.slice(1);return r.toUpperCase()+a});e.exports=function(e){return D(_(e).toLowerCase())}},36962:(e,i,t)=>{"use strict";t.d(i,{b2:()=>N,ch:()=>O,Xi:()=>_,RM:()=>D,yT:()=>T,uq:()=>S,v_:()=>x,iA:()=>C,a6:()=>k,r2:()=>Z,D:()=>R,k6:()=>a,uN:()=>le,zV:()=>l,g8:()=>c,xK:()=>he,ZC:()=>m,Fc:()=>y,kD:()=>p,PC:()=>g,Gn:()=>u});var n=t(52983),s=t(83282),o=t(25048);const r=(0,t(91890).Ue)((e=>({initialed:!1,history:[],historyMap:{},appendHistory(i){e((0,o.ZP)((e=>{e.initialed=!0,e.history=[...e.history,...i.map((e=>e.hash))],e.historyMap=Object.assign(Object.assign({},e.historyMap),i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.hash]:i})),{}))})))},resetHistory(){e((0,o.ZP)((e=>{e.initialed=!1,e.history=[],e.historyMap={}})))},tab:"",setTab(i){e((0,o.ZP)((e=>{e.tab=i})))},predictionInitialed:!1,predictionLoading:!1,predictionHasMore:!0,predictionPage:0,predictions:[],predictionMap:{},setPredictionLoading(i){e((0,o.ZP)((e=>{e.predictionLoading=i})))},setPredictionHasMore(i){e((0,o.ZP)((e=>{e.predictionHasMore=i})))},setPredictionPage(i){e((0,o.ZP)((e=>{e.predictionPage=i})))},refreshPrediction(i){e((0,o.ZP)((e=>{e.predictionInitialed&&!e.predictionLoading&&(e.predictions=[...i.map((e=>e.positionHash))],e.predictionMap=Object.assign({},i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.positionHash]:i})),{})))})))},appendPrediction(i){e((0,o.ZP)((e=>{e.predictionInitialed=!0,e.predictionHasMore=0!==i.length,e.predictions=[...e.predictions,...i.map((e=>e.positionHash))],e.predictionMap=Object.assign(Object.assign({},e.predictionMap),i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.positionHash]:i})),{}))})))},resetPrediction(){e((0,o.ZP)((e=>{e.predictionInitialed=!1,e.predictionLoading=!1,e.predictionHasMore=!0,e.predictionPage=0,e.predictions=[],e.predictionMap={}})))}}))),a=()=>r((e=>e.history)),l=()=>r((e=>e.initialed)),c=()=>[r((e=>e.tab)),r((e=>e.setTab))],d=(e,i)=>r((t=>{var n,s;return null===(s=null===(n=t.historyMap)||void 0===n?void 0:n[e])||void 0===s?void 0:s[i]})),u=()=>r((e=>e.predictions)),m=(e,i)=>r((t=>{var n,s;return null===(s=null===(n=t.predictionMap)||void 0===n?void 0:n[e])||void 0===s?void 0:s[i]})),p=()=>r((e=>e.predictionInitialed)),g=()=>r((e=>e.predictionLoading)),y=()=>r((e=>e.predictionHasMore));var v=t(69685);const f=e=>{const i=d(e,"margin"),t=d(e,"tokenSymbol"),o=(0,v.h)()[t]||t,r=(0,s.RK)(o),a=!!t;return(0,n.useMemo)((()=>({initialed:a,symbol:t,margin:i,qtyPrecision:r})),[a,t,i,r])},h=e=>{const{symbol:i}=f(e),t=(0,s.Ms)(i);return(0,n.useMemo)((()=>t),[t])};var P=t(73337),b=t(17921);const L=e=>{const i=d(e,"openFee"),t=d(e,"closeFee"),s=d(e,"fundingFee"),o=d(e,"executionFee"),r=d(e,"holdingFee");return(0,n.useMemo)((()=>({openFee:i,closeFee:t,fundingFee:s,executionFee:o,holdingFee:r})),[t,o,s,r,i])},N=e=>{const i=d(e,"actionType"),t=(0,v.h)(),{openFee:s,closeFee:o,executionFee:r}=L(e),{initialed:a,symbol:l,qtyPrecision:c}=f(e);return(0,n.useMemo)((()=>{let e=new b.Z("-");return"OPEN"===i&&(e=new b.Z(s).plus(r)),"CLOSE"!==i&&"TP"!==i&&"SL"!==i&&"LIQUIDATED"!==i||(e=new b.Z(o)),"CANCEL_LIMIT"!==i&&"SYSTEM_CANCEL"!==i||(e=new b.Z("-")),a&&e.isFinite()?`${(0,P.uf)(e,c)} ${t[l]||l}`:"-"}),[i,o,r,a,s,l,c,t])},E=e=>{const i=f(e),{symbol:t,index:s}=h(e);return(0,n.useMemo)((()=>Object.assign(Object.assign({},i),{initialed:i.initialed&&void 0!==t,margin:new b.Z(i.margin).multipliedBy(s)})),[s,i,t])},O=e=>{const i=(e=>{const i=d(e,"qty"),t=d(e,"entryPrice"),{margin:s,initialed:o}=E(e);return(0,n.useMemo)((()=>o?new b.Z(i).multipliedBy(t).dividedBy(s):new b.Z(1/0)),[t,o,s,i])})(e);return(0,n.useMemo)((()=>i.isFinite()?`${i.toFixed(1)}x`:"-"),[i])};var w=t(89479),F=t.n(w),M=t(90974);const B=e=>{const i=d(e,"actionType"),t=d(e,"entryPrice"),s=d(e,"closePrice");return(0,n.useMemo)((()=>"CANCEL_LIMIT"===i||"SYSTEM_CANCEL"===i?"-":"OPEN"===i?t:"LIQUIDATED"===i||"TP"===i||"SL"===i||"CLOSE"===i?s:"-"),[i,s,t])},T=e=>{const i=d(e,"pair"),t=B(e),o=(0,s.fV)(i);return(0,n.useMemo)((()=>{const e=new b.Z(t);return e.isFinite()?(0,P.uf)(e,o):"-"}),[t,o])},_=e=>{const i=d(e,"actionType"),t=d(e,"side"),s=d(e,"qty"),o=d(e,"pair"),r=d(e,"timestamp"),{getI18n:a}=(0,M.V6)(),l=B(e),c=T(e),{symbol:u,qtyPrecision:m}=f(e),p=(0,n.useMemo)((()=>{const e=new b.Z(s).multipliedBy(l);return e.isFinite()?(0,P.uf)(e,m):"-"}),[l,s,m]),g=(0,n.useMemo)((()=>"CANCEL_LIMIT"===i||"SYSTEM_CANCEL"===i),[i]),y=(0,n.useMemo)((()=>{const e=(0,P.Bv)(Number(r));return(0,P.Bv)().diff(e,"hour")>24?e.format("YYYY-MM-DD"):e.format("HH:mm:ss")}),[r]);return(0,n.useMemo)((()=>({side:a(`userinfo-history-side-${t.toUpperCase()}`,F()(t))||F()(t),symbol:o,price:c,size:p,isCancelOrSystemCancel:g,timeFormat:y,marginToken:u})),[c,a,g,o,t,p,y,u])},D=e=>{const i=(0,v.h)(),t=d(e,"pnl"),s=d(e,"actionType"),{fundingFee:o,holdingFee:r}=L(e),{initialed:a,margin:l,symbol:c,qtyPrecision:u}=f(e);return(0,n.useMemo)((()=>{const e=i[c]||c;if("CLOSE"===s||"LIQUIDATED"===s||"TP"===s||"SL"===s){const i=new b.Z(t).plus(o).minus(r),n=new b.Z(i).dividedBy(l),s=(0,P.uf)(i,u),c=`${(0,P.uf)(n.multipliedBy(100),2)}%`;return{PNL:a&&i.isFinite()?i.isNegative()?`${s} ${e}`:`+${s} ${e}`:"-",PNLNFormat:a&&i.isFinite()?i.isNegative()?(0,P.pF)(i.toNumber(),u):`+${(0,P.pF)(i.toNumber(),u)}`:"-",ROI:a&&n.isFinite()?n.isNegative()?c:`+${c}`:"-",isPNLNegative:i.isNegative(),isROINegative:n.isNegative(),tokenInSymbol:e}}return{PNL:"-",ROI:"-",isPNLNegative:void 0,isROINegative:void 0,PNLNFormat:"-",tokenInSymbol:e}}),[s,o,r,a,l,t,u,c,i])},S=e=>{const{getI18n:i}=(0,M.V6)(),t=d(e,"side");return(0,n.useMemo)((()=>i(`userinfo-history-side-${t.toUpperCase()}`,F()(t))||F()(t)),[i,t])},x=e=>{const i=d(e,"qty"),t=d(e,"entryPrice"),s=d(e,"closePrice"),o=d(e,"actionType");return(0,n.useMemo)((()=>{let e=new b.Z("-");return"OPEN"===o&&(e=new b.Z(t).multipliedBy(i)),"CLOSE"!==o&&"SL"!==o&&"TP"!==o&&"LIQUIDATED"!==o||(e=new b.Z(s).multipliedBy(i)),e.isFinite()?(0,P.uf)(e.toFixed(1),1):"-"}),[o,s,t,i])};var I=t(87718);const C=e=>{const i=d(e,"pair"),t=d(e,"isLong"),{productMap:s}=(0,I.GS)();return(0,n.useMemo)((()=>{var e,n;return{symbol:i,isLong:t,symbolType:null===(e=s[i])||void 0===e?void 0:e.symbolType,symbolName:null===(n=s[i])||void 0===n?void 0:n.symbolName}}),[i,t,s])},k=e=>{const i=d(e,"timestamp");return(0,n.useMemo)((()=>(0,P.Bv)(Number(i)).isValid()?(0,P.Bv)(Number(i)).format("MM-DD HH:mm:ss"):"-"),[i])},Z=e=>{const i=d(e,"actionType"),{getI18n:t}=(0,M.V6)();return(0,n.useMemo)((()=>i?t(`userinfo-history-type-${i.toUpperCase()}`,{defaultValue:i.toUpperCase()}):"-"),[t,i])};var H=t(45779);const R=()=>({useHistoryTab:c,fetchPredictions:()=>{H.ee.emit("FETCH_DUMB_HISTORY_LIST",void 0)},usePredictionDataByFiled:m,usePredictionHasMore:y,usePredictionInitialed:p,usePredictionLoading:g,usePredictions:u,usePricePrecision:s.fV,useAssetPrecision:s.RK});var A=t(25315),$=t(53958),q=t(24121),U=t(62452);const j=e=>{const i=(0,U.E)(),{data:t}=(0,q.do)(Object.assign(Object.assign({},i),{functionName:"pairsV3",staleTime:1/0,scopeKey:"pairs"}));return(0,n.useMemo)((()=>{var i;return(null===(i=(t||[]).find((i=>i.name.replace("/","")===e)))||void 0===i?void 0:i.base)||""}),[t,e])},G=e=>{const i=d(e,"qty"),t=d(e,"pair"),o=j(t),r=d(e,"entryPrice"),a=(0,n.useMemo)((()=>new b.Z(i).multipliedBy(r)),[r,i]),l=(0,s.tz)(o,a);return(0,n.useMemo)((()=>(0,$.mb)(null==l?void 0:l.liqLostP,A.cB.percent)),[l])},V=e=>{const i=d(e,"timestamp"),{getI18n:t}=(0,M.V6)();return(0,n.useMemo)((()=>(0,P.jE)(Number(i),t)),[i,t])},z=e=>{const{openFee:i,executionFee:t,fundingFee:s,closeFee:o,holdingFee:r}=L(e),{symbol:a,index:l}=h(e);return(0,n.useMemo)((()=>({initialed:void 0!==a,openFee:new b.Z(i).multipliedBy(l),closeFee:new b.Z(o).multipliedBy(l),fundingFee:new b.Z(s).multipliedBy(l),executionFee:new b.Z(t).multipliedBy(l),holdingFee:new b.Z(r).multipliedBy(l)})),[a,i,l,o,s,t,r])},Y=e=>{const i=(0,v.h)(),{fundingFee:t,holdingFee:s}=L(e),{fundingFee:o,holdingFee:r}=z(e),{symbol:a,qtyPrecision:l}=f(e);return(0,n.useMemo)((()=>{const e=new b.Z(t).minus(s);return{fundingFee:`${e.isNegative()?"":"+"}${(0,P.FL)(e,l)} ${i[a]||a} ( ≈ ${(0,P.uf)(new b.Z(o).minus(r),2)} USD )`,isFundingFeeNegative:e.isNegative()}}),[t,s,l,a,o,r,i])},Q=e=>{const i=(0,v.h)(),{margin:t,symbol:s,qtyPrecision:o}=f(e),{margin:r}=E(e);return(0,n.useMemo)((()=>`${(0,P.FL)(t,o)} ${i[s]||s} ( ≈ ${(0,P.uf)(r,1)} USD )`),[t,o,s,r,i])};var K=t(88016);const J=["CLOSE","TP","SL","LIQUIDATED"],W=["CANCEL_LIMIT","SYSTEM_CANCEL"],X=["OPEN"],ee=e=>{const{getI18n:i}=(0,M.V6)(),t=d(e,"actionType"),s=i(`userinfo-history-type-${null==t?void 0:t.toUpperCase()}`,{defaultValue:null==t?void 0:t.toUpperCase()}),o=(0,n.useMemo)((()=>[{types:J,type:K.K.Close},{types:X,type:K.K.Open},{types:W,type:K.K.CancelLimit}]),[]);return(0,n.useMemo)((()=>Object.assign(Object.assign({},o.find((e=>e.types.includes(null==t?void 0:t.toUpperCase())))||{type:void 0}),{i18n:s})),[t,s,o])},ie=e=>{const i=(0,v.h)(),t=d(e,"pnl"),{margin:s,symbol:o,qtyPrecision:r}=f(e),a=d(e,"actionType"),{fundingFee:l}=L(e),{index:c}=h(e);return(0,n.useMemo)((()=>{const e=i[o]||o;if(J.includes(a)){const i=new b.Z(t).plus(l),n=new b.Z(i).dividedBy(s),o=(0,P.FL)(i,r),a=`${(0,P.uf)(n.multipliedBy(100),2)}%`,d=i.isNegative(),u=i.isPositive(),m=n.isNegative();return{PNL:i.isFinite()?`${d?"":"+"}${o} ${e} ( ≈ ${(0,P.uf)(i.multipliedBy(c),1)} USD\n        )`:"-",PNLOrigin:i,PNLFormatted:o,ROI:n.isFinite()?`${m?"":"+"}${a}`:"-",isPNLNegative:d,isROINegative:m,isPNLPositive:u,tokenInSymbol:e}}return{PNL:"-",PNLOrigin:new b.Z(0),PNLFormatted:"-",ROI:"-",isPNLNegative:!1,isROINegative:!1,isPNLPositive:!1,tokenInSymbol:e}}),[a,l,c,s,t,r,o,i])},te=e=>{const{PNLOrigin:i}=ie(e),{openFee:t,executionFee:n,closeFee:s}=L(e);return i.minus(t).minus(n).minus(s)},ne=e=>{const i=(0,v.h)(),{symbol:t,qtyPrecision:s}=f(e),o=te(e),r=(e=>{const i=te(e),{index:t}=h(e);return i.multipliedBy(t)})(e);return(0,n.useMemo)((()=>({netProfit:o.isNaN()?"-":`${o.isNegative()?"":"+"}${(0,P.FL)(o.toNumber(),s)} ${i[t]||t} ( ≈ ${(0,P.uf)(r,1)} USD )`,isNetProfitNegative:o.isNegative()})),[o,s,t,r,i])},se=e=>{const i=(0,v.h)(),{openFee:t,closeFee:o,executionFee:r}=L(e),{openFee:a,closeFee:l,executionFee:c}=z(e),u=d(e,"pair"),m=j(u),{data:p}=(0,s.Bu)(m),{symbol:g,qtyPrecision:y}=f(e);return(0,n.useMemo)((()=>{var e,n;return{isDynamicClosingFee:Boolean(p.feeConfig&&(null===(e=p.feeConfig)||void 0===e?void 0:e.shareP)>0&&(null===(n=p.feeConfig)||void 0===n?void 0:n.minCloseFeeP)>0),openFee:`${(0,P.FL)(new b.Z(t),y)} ${i[g]||g} ( ≈ ${(0,P.uf)(a,2)} USD )`,executionFee:`${(0,P.FL)(new b.Z(r),y)} ${i[g]||g} ( ≈ ${(0,P.uf)(c,2)} USD )`,closeFee:`${(0,P.FL)(o,y)} ${i[g]||g} ( ≈ ${(0,P.uf)(l,2)} USD )`}}),[p.feeConfig,t,y,g,a,r,c,o,l,i])},oe=e=>{const i=d(e,"pair"),t=(0,I.Lh)(i,"baseAsset");return(0,n.useMemo)((()=>({pair:i,baseAsset:t})),[i,t])},re=e=>{const i=d(e,"pair"),t=d(e,"entryPrice"),o=d(e,"closePrice"),r=(0,s.fV)(i);return(0,n.useMemo)((()=>({entryPrice:new b.Z(t).isFinite()?(0,P.uf)(t,r):"-",closePrice:new b.Z(o).isFinite()?(0,P.uf)(o,r):"-"})),[t,r,o])},ae=e=>{const i=x(e),t=d(e,"qty"),s=d(e,"pair"),o=(0,I.Lh)(s,"quantityPrecision");return(0,n.useMemo)((()=>({size:i,qty:(0,P.uf)(t,o)})),[t,o,i])},le=()=>(0,n.useMemo)((()=>({useHistoryDetailType:ee,useHistoryDetailPair:oe,useHistoryDetailLeverage:O,useHistoryDetailInitialMargin:Q,useHistoryDetailSymbol:C,useHistoryDetailQtyAndSize:ae,useHistoryDetailFundingFee:Y,useHistoryDetailOpenCloseFee:se,useHistoryDetailPrice:re,useHistoryDetailLiqLostRate:G,useHistoryDetailPNLROI:ie,useHistoryDetailNetProfit:ne,useHistoryDetailDuration:V})),[]);var ce=t(76398),de=t(48608),ue=t(34221),me=t(31422),pe=t(42623),ge=t(74387),ye=t(33801),ve=t(59712);const fe={LIMIT:{label:"LIMIT",index:0},CANCEL_LIMIT:{label:"CANCEL_LIMIT",index:1},SYSTEM_CANCEL:{label:"SYSTEM_CANCEL",index:2},OPEN:{label:"OPEN",index:3},CLOSE:{label:"CLOSE",index:4},TP:{label:"TP",index:5},SL:{label:"SL",index:6},LIQ:{label:"LIQUIDATED",index:7}},he=()=>{const{selectedNetworkId:e}=(0,ue.o6)(),i=(0,q.xx)({chainId:e}),{address:t,isConnected:o}=(0,q.mA)(),a=r((e=>e.appendHistory)),l=r((e=>e.resetHistory)),c=r((e=>e.predictionPage)),d=r((e=>e.appendPrediction)),u=r((e=>e.resetPrediction)),m=r((e=>e.refreshPrediction)),p=r((e=>e.setPredictionLoading)),g=r((e=>e.setPredictionHasMore)),y=r((e=>e.setPredictionPage)),v=(0,s.bC)({page:1,limit:10*c}),[f,h]=(0,n.useState)(!1),[P,b]=(0,n.useState)(!1),L=(0,n.useRef)(0),N=(0,n.useRef)(0),E=(0,de.D)((()=>(0,ce.__awaiter)(void 0,void 0,void 0,(function*(){if(!o||!t)return;if(P)return;b(!0);const{orderAndTradeHistories:e}=yield(({chainId:e,address:i,page:t=1,limit:n=10})=>(0,ce.__awaiter)(void 0,void 0,void 0,(function*(){const s=(0,pe.pT)(e);try{if(!i&&!s)return{order:null};const e=(0,ye.VH)(ge.IY,(null==s?void 0:s.apiNetwork)||"bnb"),o={query:"\n  query OrderAndTradeHistorys($skip: Int, $first: Int, $user: String) {\n    orderAndTradeHistories(\n        skip: $skip\n        first: $first\n        orderBy: timestamp\n        orderDirection: desc\n        where: { \n            user: $user\n            actionType_not: ADD_MARGIN\n        }\n    ) {\n        id\n        orderOrTradeHash\n        actionType\n        timestamp\n        txHash\n        limitOrder {\n            pair {\n                name\n            }\n            isLong\n            token {\n                symbol\n            }\n            amountIn\n            limitPrice\n            qty\n            takeProfit\n            stopLoss\n        }\n        trade {\n            pair {\n                name\n            }\n            isLong\n            token {\n                symbol\n            }\n            margin\n            entryPrice\n            qty\n            openFee\n            executionFee\n            closeType\n            closePrice\n            closeFee\n            fundingFee\n            holdingFee\n            pnl\n            actualPnl\n        }\n    }\n}\n",variables:{user:i,skip:t,first:n}},r={method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(o)};return(yield(yield fetch(e,r)).json()).data}catch(e){return ve.error(e),{order:null}}})))({chainId:i,address:t,page:10*L.current,limit:10}),n=e||[];L.current+=1,N.current+=n.length,b(!1),h(10*L.current<=N.current);const s=n.filter((e=>"LIMIT"!==e.actionType)).map((e=>{var i,t,n,s,o,r,a,l,c,d,u,m,p,g;const y=fe[e.actionType]||{},v={hash:`${e.orderOrTradeHash}-${e.timestamp}-${y.index}`,timestamp:`${e.timestamp}000`,actionType:y.label,side:"LONG",pair:"",tokenSymbol:"",isLong:!1,qty:"",entryPrice:"",margin:"",closePrice:"",openFee:"",fundingFee:"",closeFee:"",executionFee:"",holdingFee:"",pnl:""};let f={};return f="CANCEL_LIMIT"===e.actionType||"SYSTEM_CANCEL"===e.actionType?{pair:e.limitOrder.pair.name.replace("/",""),isLong:e.limitOrder.isLong,side:e.limitOrder.isLong?"LONG":"SHORT",tokenSymbol:e.limitOrder.token.symbol}:{pair:null===(i=e.trade)||void 0===i?void 0:i.pair.name.replace("/",""),isLong:null===(t=e.trade)||void 0===t?void 0:t.isLong,side:(null===(n=e.trade)||void 0===n?void 0:n.isLong)?"LONG":"SHORT",qty:null===(s=e.trade)||void 0===s?void 0:s.qty,entryPrice:null===(o=e.trade)||void 0===o?void 0:o.entryPrice,closePrice:null===(r=e.trade)||void 0===r?void 0:r.closePrice,margin:null===(a=e.trade)||void 0===a?void 0:a.margin,openFee:null===(l=e.trade)||void 0===l?void 0:l.openFee,executionFee:null===(c=e.trade)||void 0===c?void 0:c.executionFee,fundingFee:null===(d=e.trade)||void 0===d?void 0:d.fundingFee,closeFee:null===(u=e.trade)||void 0===u?void 0:u.closeFee,holdingFee:null===(m=e.trade)||void 0===m?void 0:m.holdingFee,pnl:null===(p=e.trade)||void 0===p?void 0:p.pnl,tokenSymbol:null===(g=e.trade)||void 0===g?void 0:g.token.symbol},Object.assign(Object.assign(Object.assign({},e),v),f)}));a(s)}))));(0,n.useEffect)((()=>{o||(a([]),d([]))}),[a,d,o]),(0,n.useEffect)((()=>(o&&E(),()=>{o&&(l(),u(),L.current=0,N.current=0)})),[o]);const O=(0,de.D)((()=>(0,ce.__awaiter)(void 0,void 0,void 0,(function*(){p(!0);const e=yield(0,me.Q)({account:t,chainId:i,page:c+1,limit:10});e.success?(d(e.data),y(c+1)):g(!1),p(!1)}))));return(0,n.useEffect)((()=>(o&&t?H.ee.on("FETCH_DUMB_HISTORY_LIST",O):H.ee.off("FETCH_DUMB_HISTORY_LIST",O),()=>{H.ee.off("FETCH_DUMB_HISTORY_LIST",O)})),[t,o,O]),(0,n.useEffect)((()=>{v.data&&v.data.success&&m(v.data.data)}),[m,v]),(0,n.useMemo)((()=>({loadMore:E,hasMore:f,loadMoreLoading:P})),[E,f,P])}},38097:(e,i,t)=>{"use strict";t.d(i,{d0:()=>y,SD:()=>h,ch:()=>L,uT:()=>N,PH:()=>E,v_:()=>O,iA:()=>w,a1:()=>F,Ub:()=>M,Gc:()=>I,Jo:()=>Z,M2:()=>$,CE:()=>q,ls:()=>j,yi:()=>c,uY:()=>d});var n=t(52983),s=t(83282),o=t(53958),r=t(17921),a=t(25048);const l=(0,t(91890).Ue)((e=>({initialed:!1,orders:[],orderMap:{},initialOrders(i){e((0,a.ZP)((e=>{e.initialed=!0,e.orders=i.map((e=>e.hash)),e.orderMap=i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.hash]:i})),{})})))},addAOrder(i){e((0,a.ZP)((e=>{e.orders.push(i.hash),e.orderMap[i.hash]=i})))},deleteAOrderByHash(i){e((0,a.ZP)((e=>{delete e.orderMap[i],e.orders=e.orders.filter((e=>e!==i))})))}}))),c=()=>l((e=>e.orders)),d=()=>l((e=>e.initialed)),u=(e,i)=>l((t=>{var n,s;return null===(s=null===(n=t.orderMap)||void 0===n?void 0:n[e])||void 0===s?void 0:s[i]})),m=e=>{const i=u(e,"amountIn"),t=u(e,"tokenIn"),a=(0,s.QG)(t),l=(0,s.At)(t),c=(0,s.RK)(l),d=l&&void 0!==a;return(0,n.useMemo)((()=>({initialed:d,symbol:l,decimals:a,address:t,tokenIn:t,amountIn:new r.Z((0,o.mb)(i,a)),qtyPrecision:c})),[d,l,a,t,i,c])},p=e=>{const{symbol:i}=m(e),t=(0,s.Ms)(i);return(0,n.useMemo)((()=>t),[t])};var g=t(87718);const y=()=>{const{symbol:e}=(0,g.Dp)(),i=(0,s.d0)();return(0,n.useCallback)((t=>{var n;t!==e&&(i({isBlank:!1,stateSymbol:t}),null===(n=document.querySelector("#orderForm"))||void 0===n||n.scrollIntoView({behavior:"smooth"}))}),[i,e])};var v=t(69685),f=t(73337);const h=e=>{const i=(e=>{const{amountIn:i}=m(e);return(0,n.useMemo)((()=>new r.Z(i)),[i])})(e),t=(0,v.h)(),{initialed:s,symbol:o,qtyPrecision:a}=m(e);return(0,n.useMemo)((()=>s&&i.isFinite()?`${(0,f.uf)(i,a)} ${t[o]||o}`:"-"),[i,s,o,a,t])};var P=t(25315);const b=e=>{const i=u(e,"qty"),t=u(e,"limitPrice"),{initialed:a,amountIn:l}=m(e),c=(e=>{const i=u(e,"qty"),t=u(e,"pairBase"),a=u(e,"limitPrice"),{data:l}=(0,s.Bu)(t,{watch:!0});return(0,n.useMemo)((()=>l&&l.feeConfig&&l.feeConfig.openFeeP?new r.Z(i).multipliedBy(a).multipliedBy((0,o.mb)(l.feeConfig.openFeeP,P.cB.percent)):"-"),[l,a,i])})(e),{data:d}=(0,s.VT)(),{symbol:g,index:y}=p(e),v=g&&a;return(0,n.useMemo)((()=>v?new r.Z(i).multipliedBy(t).dividedBy(new r.Z(l).multipliedBy(y).minus(c).minus((0,o.mb)(null==d?void 0:d.executionFeeUsd.toString(),P.cB.usd))):new r.Z(1/0)),[v,i,t,l,y,c,null==d?void 0:d.executionFeeUsd])},L=e=>{const i=b(e);return(0,n.useMemo)((()=>i.isFinite()?`${i.toFixed(1)}x`:"-"),[i])},N=e=>{const i=u(e,"limitPrice"),t=u(e,"pair"),o=(0,s.fV)(t);return(0,n.useMemo)((()=>{const e=new r.Z(i);return e.isFinite()?(0,f.uf)(e,o):"-"}),[i,o])},E=e=>{const i=u(e,"pair"),t=(0,s.fV)(i),{close:o}=(0,s.Le)(i);return(0,n.useMemo)((()=>{const e=new r.Z(o);return e.isFinite()?(0,f.uf)(e,t):"-"}),[o,t])},O=e=>{const i=u(e,"qty"),t=u(e,"limitPrice");return(0,n.useMemo)((()=>{const e=new r.Z(i).multipliedBy(t);return e.isFinite()?e.toFixed(1):"-"}),[t,i])},w=e=>{const i=u(e,"pair"),t=u(e,"isLong"),{productMap:s}=(0,g.GS)();return(0,n.useMemo)((()=>{var e,n;return{symbol:i,isLong:t,symbolType:null===(e=s[i])||void 0===e?void 0:e.symbolType,symbolName:null===(n=s[i])||void 0===n?void 0:n.symbolName}}),[t,i,s])},F=e=>{const i=u(e,"takeProfit"),t=u(e,"stopLoss"),o=u(e,"pair"),a=(0,s.fV)(o);return(0,n.useMemo)((()=>{const e=new r.Z(i),n=new r.Z(t);return{takeProfit:e.isFinite()?(0,f.uf)(e,a):"-",stopLoss:n.isFinite()&&!n.isEqualTo(0)?(0,f.uf)(n,a):"-"}}),[a,t,i])},M=e=>{const i=u(e,"limitPrice"),t=u(e,"side"),a=u(e,"pair"),l=(0,s.fV)(a),c=(e=>{const i=u(e,"pair"),t=u(e,"pairBase"),a=u(e,"isLong"),l=u(e,"qty"),{close:c}=(0,s.Le)(i),{data:d}=(0,s.Bu)(t),{data:m}=(0,s.Jg)(t);return(0,n.useMemo)((()=>{if(d&&m){const{slippageType:e,onePercentDepthAboveUsd:i,onePercentDepthBelowUsd:t,slippageLongP:n,slippageShortP:s}=d.slippageConfig||{},{longQty:u,shortQty:p}=m;if(1===e)return a?new r.Z(l).multipliedBy(c).plus(new r.Z((0,o.mb)(u.toString(),P.cB.qty)).multipliedBy(c)).dividedBy((0,o.mb)(i.toString(),P.cB.usd)).toFixed(4,r.Z.ROUND_UP):new r.Z(l).multipliedBy(c).plus(new r.Z((0,o.mb)(p.toString(),P.cB.qty)).multipliedBy(c)).dividedBy((0,o.mb)(t.toString(),P.cB.usd)).toFixed(4,r.Z.ROUND_UP);if(0===e)return a?(0,o.mb)(n.toString(),P.cB.percent):(0,o.mb)(s.toString(),P.cB.percent);if(2===e){const e=new r.Z(l).multipliedBy(c),d=new r.Z((0,o.mb)(u.toString(),P.cB.qty)).multipliedBy(c),m=new r.Z((0,o.mb)(p.toString(),P.cB.qty)).multipliedBy(c),g=(0,o.mb)((a?i:t).toString(),P.cB.usd),y=new r.Z((0,o.mb)((a?n:s).toString(),P.cB.percent)),v=(a?e.minus(m).plus(d):e.minus(d).plus(m)).dividedBy(g);return r.Z.max(v,y).toFixed(4,r.Z.ROUND_UP)}return NaN}return NaN}),[a,c,m,d,l])})(e),d=(0,n.useMemo)((()=>"LONG"===t),[t]);return(0,n.useMemo)((()=>{const e=d?new r.Z(i).multipliedBy(new r.Z(1).minus(c)):new r.Z(i).multipliedBy(new r.Z(1).plus(c));return e.isFinite()?(0,f.uf)(e,l):"-"}),[d,i,l,c])};var B=t(76398),T=t(70165),_=t(24121),D=t(63299),S=t(45779),x=t(90974);const I=()=>{const{setDisabled:e}=(0,g.a9)(),{getI18n:i}=(0,x.V6)(),{submit:t}=(0,T.t)({getI18n:i}),o=(0,s.E4)(),r="cancelLimitOrder",{writeAsync:a}=(0,_.GG)(Object.assign(Object.assign({},o),{mode:"recklesslyUnprepared",functionName:r}));return(0,n.useCallback)((i=>(0,B.__awaiter)(void 0,void 0,void 0,(function*(){e(!0);try{const e=[i],n=yield(0,D.$q)(Object.assign(Object.assign({},o),{functionName:r,args:e})),{gasLimit:s}=n.request;yield t((()=>null==a?void 0:a({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,f.zb)(s)}}))),S.ee.emit("REFETCH_ORDER_LIST",void 0)}catch(e){}return e(!1),!0}))),[o,t,a,e])},C=new(t(42405).v);var k=t(59712);const Z=()=>{const{getI18n:e}=(0,x.V6)(),{setDisabled:i}=(0,g.a9)(),t=(0,s.E4)(),{submit:a}=(0,T.t)({getI18n:e}),{writeAsync:l}=(0,_.GG)(Object.assign(Object.assign({},t),{mode:"recklesslyUnprepared",functionName:"updateOrderTpAndSl"})),{writeAsync:c}=(0,_.GG)(Object.assign(Object.assign({},t),{mode:"recklesslyUnprepared",functionName:"updateOrderTp"})),{writeAsync:d}=(0,_.GG)(Object.assign(Object.assign({},t),{mode:"recklesslyUnprepared",functionName:"updateOrderSl"}));(0,n.useEffect)((()=>C.on("UPDATE_ORDER_TP_SL",(e=>(0,B.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:n,takeProfit:s,stopLoss:c,closeModalCallBack:d}=e;i(!0),k.debug("updateOrderTpAndSl",n,s,c);try{const e=[n,(0,o.r0)(s,P.cB.price),new r.Z(c).isEqualTo(0)||new r.Z(c).isNaN()?0:(0,o.r0)(c,P.cB.price)],i=yield(0,D.$q)(Object.assign(Object.assign({},t),{functionName:"updateOrderTpAndSl",args:e})),{gasLimit:u}=i.request;yield a((()=>null==l?void 0:l({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,f.zb)(u)}})),{onUserConfirm(){null==d||d()}}),S.ee.emit("REFETCH_ORDER_LIST",void 0)}catch(e){}i(!1)}))))),[t,a,l,i]),(0,n.useEffect)((()=>C.on("UPDATE_ORDER_TP",(e=>(0,B.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:n,takeProfit:s,closeModalCallBack:r}=e;i(!0),k.debug("updateOrderTp",n,s);try{const e=[n,(0,o.r0)(s,P.cB.price)],i=yield(0,D.$q)(Object.assign(Object.assign({},t),{functionName:"updateOrderTp",args:e})),{gasLimit:l}=i.request;yield a((()=>null==c?void 0:c({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,f.zb)(l)}})),{onUserConfirm(){null==r||r()}}),S.ee.emit("REFETCH_ORDER_LIST",void 0)}catch(e){}i(!1)}))))),[t,a,c,i]),(0,n.useEffect)((()=>C.on("UPDATE_ORDER_SL",(e=>(0,B.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:n,stopLoss:s,closeModalCallBack:l}=e;i(!0),k.debug("updateOrderSl",n,s);try{const e=[n,new r.Z(s).isEqualTo(0)||new r.Z(s).isNaN()?0:(0,o.r0)(s,P.cB.price)],i=yield(0,D.$q)(Object.assign(Object.assign({},t),{functionName:"updateOrderSl",args:e})),{gasLimit:c}=i.request;yield a((()=>null==d?void 0:d({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,f.zb)(c)}})),{onUserConfirm(){null==l||l()}}),S.ee.emit("REFETCH_ORDER_LIST",void 0)}catch(e){}i(!1)}))))),[t,a,d,i])},H=()=>(0,n.useMemo)((()=>({updateTpAndSl:({hash:e,takeProfit:i,stopLoss:t},n)=>(0,B.__awaiter)(void 0,void 0,void 0,(function*(){C.emit("UPDATE_ORDER_TP_SL",{hash:e,takeProfit:i,stopLoss:t,closeModalCallBack:n})})),updateTp:({hash:e,takeProfit:i},t)=>(0,B.__awaiter)(void 0,void 0,void 0,(function*(){C.emit("UPDATE_ORDER_TP",{hash:e,takeProfit:i,closeModalCallBack:t})})),updateSl:({hash:e,stopLoss:i},t)=>(0,B.__awaiter)(void 0,void 0,void 0,(function*(){C.emit("UPDATE_ORDER_SL",{hash:e,stopLoss:i,closeModalCallBack:t})}))})),[]);var R=t(20098);const A=e=>e.map((e=>{const i={orderHash:e.orderHash,broker:e.broker,pair:e.pair.replace("/",""),pairBase:e.pairBase,isLong:e.isLong,tokenIn:e.tokenIn,amountIn:e.amountIn.toString(),qty:(0,o.mb)(e.qty.toString(),P.cB.qty),limitPrice:(0,o.mb)(e.limitPrice.toString(),P.cB.price),stopLoss:(0,o.mb)(e.stopLoss.toString(),P.cB.price),takeProfit:(0,o.mb)(e.takeProfit.toString(),P.cB.price),timestamp:`${e.timestamp}000`,hash:e.orderHash,side:e.isLong?"LONG":"SHORT"};return Object.assign(Object.assign({},e),i)})).sort(((e,i)=>Number(i.timestamp)-Number(e.timestamp))),$=()=>{const e=(0,s.E4)(),{address:i,isConnected:t}=(0,_.mA)(),o=l((e=>e.initialOrders)),r=d(),{data:a=[],refetch:c,isSuccess:u,isFetching:m}=(0,_.do)(Object.assign(Object.assign({},e),{functionName:"getLimitOrders",args:[i,"0x0000000000000000000000000000000000000000"],enabled:t,cacheOnBlock:!0,cacheTime:R.g_}));(0,n.useEffect)((()=>{t||o([])}),[o,t]),(0,n.useEffect)((()=>{u&&!r&&o(A(a))}),[a,o,u,r]),(0,n.useEffect)((()=>{r&&!m&&o(A(a))}),[a,o,m,r]),(0,n.useEffect)((()=>S.ee.on("REFETCH_ORDER_LIST",(()=>{c()}))),[c])},q=e=>{const{close:i}=(0,s.Le)(e);return(0,n.useMemo)((()=>i),[i])};var U=t(59629);const j=e=>{const i=(0,v.h)(),t=u(e,"qty"),a=u(e,"limitPrice"),l=u(e,"side"),c=u(e,"pair"),d=u(e,"takeProfit"),g=u(e,"stopLoss"),y=(0,s.fV)(c),h=b(e),{data:L}=(0,s.VT)(),{index:N}=p(e),{qtyPrecision:E,symbol:O}=m(e),w=(0,n.useMemo)((()=>"LONG"===l),[l]),F=(0,n.useMemo)((()=>E),[E]),M=(0,n.useMemo)((()=>2),[]),B=(0,n.useMemo)((()=>w?(null==L?void 0:L.maxTakeProfitP)?(0,o.mb)(L.maxTakeProfitP,P.cB.percent):"Infinity":(null==L?void 0:L.maxTakeProfitP)?r.Z.minimum(new r.Z(h),(0,o.mb)(L.maxTakeProfitP,P.cB.percent)).toString():"Infinity"),[w,h,null==L?void 0:L.maxTakeProfitP]),T=(e=>{const i=u(e,"qty"),t=u(e,"pairBase"),a=u(e,"limitPrice"),l=(0,n.useMemo)((()=>new r.Z(i).multipliedBy(a)),[a,i]),c=(0,s.tz)(t,l);return(0,n.useMemo)((()=>(0,o.mb)(null==c?void 0:c.liqLostP,P.cB.percent)),[c])})(e),_=(0,U.D)((e=>w?new r.Z(e).multipliedBy(N).dividedBy(t).plus(a):new r.Z(a).minus(new r.Z(e).multipliedBy(N).dividedBy(t)))),D=(0,U.D)((e=>w?new r.Z(e).minus(a).multipliedBy(t).dividedBy(N):new r.Z(a).minus(e).multipliedBy(t).dividedBy(N))),S=(0,U.D)((e=>new r.Z(t).multipliedBy(a).multipliedBy(e).dividedBy(h).dividedBy(N))),x=(0,U.D)((e=>new r.Z(e).multipliedBy(N).multipliedBy(h).dividedBy(new r.Z(t).multipliedBy(a)))),I=(0,U.D)((e=>w?new r.Z(e).multipliedBy(N).dividedBy(t).plus(a):new r.Z(a).minus(new r.Z(e).multipliedBy(N).dividedBy(t)))),C=(0,U.D)((e=>w?new r.Z(e).minus(a).multipliedBy(t).dividedBy(N):new r.Z(a).minus(e).multipliedBy(t).dividedBy(N))),k=(0,U.D)((e=>new r.Z(t).multipliedBy(a).multipliedBy(e).dividedBy(h).dividedBy(N))),Z=(0,U.D)((e=>new r.Z(e).multipliedBy(N).multipliedBy(h).dividedBy(new r.Z(t).multipliedBy(a)))),R=(0,U.D)((e=>`${(0,f.uf)(e,F)} ${i[O]||O}`)),A=(0,U.D)((e=>(0,f.uf)(e,M))),$=(0,U.D)((e=>(0,f.uf)(e,y)));return(0,n.useMemo)((()=>({getTakeProfitPrice:_,getTakeProfitPNL:D,getTakeProfitPNLByROI:S,getTakeProfitROI:x,getStopLossPrice:I,getStopLossPNL:C,getStopLossPNLByROI:k,getStopLossROI:Z,pair:c,takeProfit:d,stopLoss:g,pricePrecision:y,PNLPrecision:F,ROIPrecision:M,side:l,maxTakeProfitROI:B,minStopLossROI:(-T).toString(),entryPrice:a,formatPNL:R,formatROI:A,formatPrice:$,useContractUpdateTPSL:H})),[_,D,S,x,I,C,k,Z,c,d,g,y,F,M,l,B,T,a,R,A,$])}},97413:(e,i,t)=>{"use strict";t.d(i,{d0:()=>P,SD:()=>N,A4:()=>E,ch:()=>F,lW:()=>D,PH:()=>S,RM:()=>I,v_:()=>C,iA:()=>k,a1:()=>Z,eO:()=>V,Im:()=>W,Jo:()=>ee,mM:()=>te,D:()=>re,OB:()=>le,rf:()=>w,CE:()=>ce,zS:()=>me,KB:()=>Oe,d:()=>c,mO:()=>Fe,$J:()=>d,Zm:()=>u,ZC:()=>g,kD:()=>y,Gn:()=>p});var n=t(52983),s=t(83282),o=t(53958),r=t(17921),a=t(25048);const l=(0,t(91890).Ue)((e=>({initialed:!1,positions:[],positionMap:{},initialPositions(i){e((0,a.ZP)((e=>{e.initialed=!0,e.positions=i.map((e=>e.hash)),e.positionMap=i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.hash]:i})),{})})))},addAPosition(i){e((0,a.ZP)((e=>{e.positions.push(i.hash),e.positionMap[i.hash]=i})))},deleteAPositionByHash(i){e((0,a.ZP)((e=>{delete e.positionMap[i],e.positions=e.positions.filter((e=>e!==i))})))},updateAPosition(i,t,n){e((0,a.ZP)((e=>{if(e.positionMap[i]){const s=e.positionMap[i];e.positionMap[i]=Object.assign(Object.assign({},s),{[t]:n})}})))},predictionInitialed:!1,predictions:[],predictionMap:{},initialPredictions(i){e((0,a.ZP)((e=>{e.predictionInitialed=!0,e.predictions=i.map((e=>e.positionHash)),e.predictionMap=i.reduce(((e,i)=>Object.assign(Object.assign({},e),{[i.positionHash]:i})),{})})))},addAPrediction(i){e((0,a.ZP)((e=>{e.predictions.push(i.positionHash),e.predictionMap[i.positionHash]=i})))},deleteAPredictionByHash(i){e((0,a.ZP)((e=>{delete e.predictionMap[i],e.predictions=e.predictions.filter((e=>e!==i))})))}}))),c=()=>{const e=l((e=>e.positions)),i=l((e=>e.predictions));return e.length+i.length},d=()=>l((e=>e.positions)),u=()=>l((e=>e.initialed)),m=(e,i)=>l((t=>{var n,s;return null===(s=null===(n=t.positionMap)||void 0===n?void 0:n[e])||void 0===s?void 0:s[i]})),p=()=>l((e=>e.predictions)),g=(e,i)=>l((t=>{var n,s;return null===(s=null===(n=t.predictionMap)||void 0===n?void 0:n[e])||void 0===s?void 0:s[i]})),y=()=>l((e=>e.predictionInitialed)),v=e=>{const i=m(e,"margin"),t=m(e,"marginToken"),a=(0,s.QG)(t),l=(0,s.At)(t),c=(0,s.RK)(l),d=l&&void 0!==i&&void 0!==a;return(0,n.useMemo)((()=>({initialed:d,symbol:l,decimals:a,margin:new r.Z((0,o.mb)(i,a)),address:t,marginToken:t,qtyPrecision:c})),[d,l,a,i,t,c])},f=e=>{const{symbol:i}=v(e),t=(0,s.Ms)(i);return(0,n.useMemo)((()=>t),[t])};var h=t(87718);const P=()=>{const{symbol:e}=(0,h.Dp)(),i=(0,s.d0)();return(0,n.useCallback)((t=>{var n;t!==e&&(i({isBlank:!1,stateSymbol:t}),null===(n=document.querySelector("#orderForm"))||void 0===n||n.scrollIntoView({behavior:"smooth"}))}),[i,e])};var b=t(69685),L=t(73337);const N=e=>{const i=(0,b.h)(),{initialed:t,margin:s,symbol:o,qtyPrecision:r}=v(e);return(0,n.useMemo)((()=>t&&s.isFinite()?`${(0,L.uf)(s,r)} ${i[o]||o}`:"-"),[t,s,r,o,i])},E=e=>{const i=m(e,"pair"),t=m(e,"entryPrice"),o=(0,s.fV)(i);return(0,n.useMemo)((()=>new r.Z(t).isFinite()?(0,L.uf)(t,o):"-"),[t,o])},O=e=>{const{symbol:i,index:t}=f(e),s=v(e);return(0,n.useMemo)((()=>Object.assign(Object.assign({},s),{initialed:s.initialed&&void 0!==i,margin:new r.Z(s.margin).multipliedBy(t)})),[t,s,i])},w=e=>{const i=m(e,"qty"),t=m(e,"entryPrice"),{margin:s,initialed:o}=O(e);return(0,n.useMemo)((()=>o?new r.Z(i).multipliedBy(t).dividedBy(s):new r.Z(1/0)),[t,s,i,o])},F=e=>{const i=w(e);return(0,n.useMemo)((()=>i.isFinite()?`${i.toFixed(1)}x`:"-"),[i])},M=e=>{const i=m(e,"openFee"),t=m(e,"executionFee"),s=m(e,"fundingFee"),r=m(e,"holdingFee"),{decimals:a}=v(e);return(0,n.useMemo)((()=>({openFee:(0,o.mb)(i,a),fundingFee:(0,o.mb)(s,a),executionFee:(0,o.mb)(t,a),holdingFee:(0,o.mb)(r,a)})),[a,t,s,r,i])},B=e=>{const{openFee:i,executionFee:t,fundingFee:s,holdingFee:o}=M(e),{symbol:a,index:l}=f(e);return(0,n.useMemo)((()=>({initialed:void 0!==a,openFee:new r.Z(i).multipliedBy(l),fundingFee:new r.Z(s).multipliedBy(l),executionFee:new r.Z(t).multipliedBy(l),holdingFee:new r.Z(o).multipliedBy(l)})),[t,s,o,l,i,a])};var T=t(25315);const _=e=>{const i=m(e,"qty"),t=m(e,"pairBase"),a=m(e,"entryPrice"),l=(0,n.useMemo)((()=>new r.Z(i).multipliedBy(a)),[a,i]),c=(0,s.tz)(t,l);return(0,n.useMemo)((()=>(0,o.mb)(null==c?void 0:c.liqLostP,T.cB.percent)),[c])},D=e=>{const i=m(e,"entryPrice"),t=m(e,"side"),o=m(e,"pair"),a=m(e,"qty"),l=(0,s.fV)(o),{initialed:c,fundingFee:d,holdingFee:u}=B(e),{initialed:p,margin:g}=O(e),y=_(e),v=c&&p,f=(0,n.useMemo)((()=>"LONG"===t),[t]),h=(0,n.useMemo)((()=>new r.Z(g).multipliedBy(y).plus(new r.Z(d).minus(u)).dividedBy(a)),[d,u,y,g,a]);return(0,n.useMemo)((()=>{const e=f?new r.Z(i).minus(h):new r.Z(i).plus(h);return v&&e.isFinite()?e.isNegative()?"-":(0,L.uf)(e,l):"-"}),[i,v,f,h,l])},S=e=>{const i=m(e,"pair"),t=(0,s.fV)(i),{close:o}=(0,s.Le)(i);return(0,n.useMemo)((()=>new r.Z(o).isFinite()?(0,L.uf)(o,t):"-"),[o,t])},x=e=>{const i=m(e,"qty"),t=m(e,"pair"),o=m(e,"entryPrice"),a=m(e,"side"),{index:l}=f(e),{fundingFee:c,holdingFee:d}=M(e),{margin:u}=v(e),{close:p}=(0,s.Le)(t),g=(0,n.useMemo)((()=>"LONG"===a),[a]),y=(0,n.useMemo)((()=>g?new r.Z(p).minus(o).multipliedBy(i).plus(c).dividedBy(l).plus(new r.Z(c).minus(d)):new r.Z(o).minus(p).multipliedBy(i).plus(c).dividedBy(l).plus(new r.Z(c).minus(d))),[o,c,d,l,g,p,i]),h=(0,n.useMemo)((()=>new r.Z(y).dividedBy(u)),[y,u]);return(0,n.useMemo)((()=>({PNL:y,ROI:h})),[y,h])},I=e=>{const i=(0,b.h)(),{PNL:t,ROI:s}=x(e),{initialed:o,symbol:r,qtyPrecision:a}=v(e);return(0,n.useMemo)((()=>{const e=(0,L.uf)(t,a),n=`${(0,L.uf)(s.multipliedBy(100),2)}%`,l=s.multipliedBy(100),c=t.isFinite(),d=s.isFinite(),u=t.isNegative(),m=t.gt(0),p=s.lt(0),g=i[r]||r;return{PNL:o&&c?u?`${e} ${g}`:`+${e} ${g}`:"-",ROI:o&&d?p?n:`+${n}`:"-",PNLAbbr:o&&c?`${u?"-":"+"}${(0,L.pF)(Math.abs(t.toNumber()),a)}`:"-",isPNLNegative:u,isPNLPositive:m,isROINegative:p,marginSymbol:g,ROIInNumber:l.toNumber()}}),[t,a,s,o,r,i])},C=e=>{const i=m(e,"qty"),t=m(e,"pair"),{close:o}=(0,s.Le)(t);return(0,n.useMemo)((()=>{const e=new r.Z(i).multipliedBy(o);return e.isFinite()?(0,L.uf)(e.toFixed(1),1):"-"}),[o,i])},k=e=>{const i=m(e,"pair"),t=m(e,"isLong"),{productMap:s}=(0,h.GS)();return(0,n.useMemo)((()=>{var e,n;return{symbol:i,isLong:t,symbolType:null===(e=s[i])||void 0===e?void 0:e.symbolType,symbolName:null===(n=s[i])||void 0===n?void 0:n.symbolName}}),[t,i,s])},Z=e=>{const i=m(e,"takeProfit"),t=m(e,"stopLoss"),o=m(e,"pair"),a=(0,s.fV)(o);return(0,n.useMemo)((()=>{const e=new r.Z(i),n=new r.Z(t);return{takeProfit:e.isFinite()?(0,L.uf)(e,a):"-",stopLoss:n.isFinite()&&!n.isEqualTo(0)?(0,L.uf)(n,a):"-"}}),[a,t,i])};var H=t(76398),R=t(70165),A=t(63299),$=t(13004),q=t(90974),U=t(45779);const j=new(t(42405).v);var G=t(59712);const V=()=>{const{track:e}=(0,s.B1)(),{getI18n:i}=(0,q.V6)(),{setDisabled:t}=(0,h.a9)(),{submit:o}=(0,R.t)({getI18n:i}),r=(0,s.E4)();(0,n.useEffect)((()=>j.on("ADD_MARGIN",(i=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:n,amount:s,closeModalCallBack:a,marginToken:l}=i;t(!0),G.debug("ADD_MARGIN",n,s),e("click_add_margin_classic_popup_button");try{const i=yield(0,A.$q)(Object.assign(Object.assign({},r),{functionName:"addMargin",args:[n,s],overrides:l?void 0:{value:$.O$.from(s)}}));yield o((()=>(0,A.n9)(Object.assign(Object.assign({},i),{request:Object.assign(Object.assign({},i.request),{gasLimit:(0,L.zb)(i.request.gasLimit)})}))),{onUserConfirm(){null==a||a()}}),e("add_margin_classic_success"),U.ee.emit("REFETCH_POSITION_LIST",void 0)}catch(i){e("add_margin_classic_error")}t(!1)}))))),[r,t,o,e])};var z=t(22819),Y=t(24121),Q=t(1750),K=t(59712);const J=()=>{const e=l((e=>e.positionMap)),{productMap:i}=(0,h.GS)();return function(e){const i=(0,n.useRef)(e);i.current=e;return(0,n.useCallback)(((...e)=>("function"==typeof i.current?i.current:()=>{})(...e)),[])}((t=>{const{pair:n}=e[t]||{};return n?i[n]?(0,Q.L)(i[n].symbolType).isDegenMode:(K.error(`useIsDegenMode productMap can not found the pair by hash ${t} and pair ${n}`),!1):(K.error(`useIsDegenMode positionMap can not found the pair by hash ${t}`),!1)}))},W=()=>{const{track:e}=(0,s.B1)(),{getI18n:i}=(0,q.V6)(),{setDisabled:t}=(0,h.a9)(),o=J(),{submit:r}=(0,R.t)({getI18n:i}),a=(0,s.E4)(),l="closeTrade",{writeAsync:c}=(0,Y.GG)(Object.assign(Object.assign({},a),{mode:"recklesslyUnprepared",functionName:l}));return(0,n.useCallback)((i=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){t(!0);const n=o(i);e(n?"click_close_degen_position_button":"click_close_classic_position_button");try{const t=[i],s=yield(0,A.$q)(Object.assign(Object.assign({},a),{functionName:l,args:t})),{gasLimit:o}=s.request;yield r((()=>null==c?void 0:c({recklesslySetUnpreparedArgs:t,recklesslySetUnpreparedOverrides:{gasLimit:(0,L.zb)(o)}})),{otherParams:{orderHash:i},secondConfirm:z.Xp,secondConfirmAddress:a.address}),e(n?"close_degen_position_success":"close_classic_position_success")}catch(i){e(n?"close_degen_position_error":"close_classic_position_error")}return U.ee.emit("REFETCH_POSITION_LIST",void 0),t(!1),!0}))),[t,o,e,a,r,c])};var X=t(59712);const ee=()=>{const{getI18n:e}=(0,q.V6)(),{setDisabled:i}=(0,h.a9)(),{track:t}=(0,s.B1)(),a=(0,s.E4)(),{submit:l}=(0,R.t)({getI18n:e}),{writeAsync:c}=(0,Y.GG)(Object.assign(Object.assign({},a),{mode:"recklesslyUnprepared",functionName:"updateTradeTpAndSl"})),{writeAsync:d}=(0,Y.GG)(Object.assign(Object.assign({},a),{mode:"recklesslyUnprepared",functionName:"updateTradeTp"})),{writeAsync:u}=(0,Y.GG)(Object.assign(Object.assign({},a),{mode:"recklesslyUnprepared",functionName:"updateTradeSl"}));(0,n.useEffect)((()=>j.on("UPDATE_TRADE_TP_SL",(e=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:n,takeProfit:s,stopLoss:d,closeModalCallBack:u}=e,m=new r.Z(d);i(!0),X.debug("updateTradeTpAndSl",n,s,d),t("class_position_edit_tpsl");try{const e=[n,(0,o.r0)(s,T.cB.price),m.isEqualTo(0)||!m.isFinite()?0:(0,o.r0)(d,T.cB.price)],i=yield(0,A.$q)(Object.assign(Object.assign({},a),{functionName:"updateTradeTpAndSl",args:e})),{gasLimit:r}=i.request;yield l((()=>null==c?void 0:c({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,L.zb)(r)}})),{onUserConfirm(){null==u||u()}}),t("class_position_edit_tpsl_success"),U.ee.emit("REFETCH_POSITION_LIST",void 0)}catch(e){t("class_position_edit_tpsl_error")}i(!1)}))))),[a,l,c,i,t]),(0,n.useEffect)((()=>j.on("UPDATE_TRADE_TP",(e=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:n,takeProfit:s,closeModalCallBack:r}=e;i(!0),X.debug("updateTradeTp",n,s),t("class_position_edit_tpsl");try{const e=[n,(0,o.r0)(s,T.cB.price)],i=yield(0,A.$q)(Object.assign(Object.assign({},a),{functionName:"updateTradeTp",args:e})),{gasLimit:c}=i.request;yield l((()=>null==d?void 0:d({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,L.zb)(c)}})),{onUserConfirm(){null==r||r()}}),t("class_position_edit_tpsl_success"),U.ee.emit("REFETCH_POSITION_LIST",void 0)}catch(e){t("class_position_edit_tpsl_error")}i(!1)}))))),[a,l,d,i,t]),(0,n.useEffect)((()=>j.on("UPDATE_TRADE_SL",(e=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){const{hash:n,stopLoss:s,closeModalCallBack:c}=e,d=new r.Z(s);i(!0),X.debug("updateTradeSl",n,s),t("class_position_edit_tpsl");try{const e=[n,d.isEqualTo(0)||!d.isFinite()?0:(0,o.r0)(s,T.cB.price)],i=yield(0,A.$q)(Object.assign(Object.assign({},a),{functionName:"updateTradeSl",args:e})),{gasLimit:r}=i.request;yield l((()=>null==u?void 0:u({recklesslySetUnpreparedArgs:e,recklesslySetUnpreparedOverrides:{gasLimit:(0,L.zb)(r)}})),{onUserConfirm(){null==c||c()}}),t("class_position_edit_tpsl_success"),U.ee.emit("REFETCH_POSITION_LIST",void 0)}catch(e){t("class_position_edit_tpsl_error")}i(!1)}))))),[a,l,u,i,t])},ie=()=>(0,n.useMemo)((()=>({updateTpAndSl:({hash:e,takeProfit:i,stopLoss:t,closeModalCallBack:n})=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){j.emit("UPDATE_TRADE_TP_SL",{hash:e,takeProfit:i,stopLoss:t,closeModalCallBack:n})})),updateTp:({hash:e,takeProfit:i,closeModalCallBack:t})=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){j.emit("UPDATE_TRADE_TP",{hash:e,takeProfit:i,closeModalCallBack:t})})),updateSl:({hash:e,stopLoss:i,closeModalCallBack:t})=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){j.emit("UPDATE_TRADE_SL",{hash:e,stopLoss:i,closeModalCallBack:t})}))})),[]),te=e=>{const i=g(e,"symbol"),t=(0,s.fV)(i),{close:o}=(0,s.Le)(i);return(0,n.useMemo)((()=>new r.Z(o).isFinite()?(0,L.uf)(o,t):"-"),[o,t])};var ne=t(20098),se=t(43749),oe=t(36962);const re=()=>{const{data:e}=(0,se.R)(),i=(0,Y.NL)();return{useHistoryTab:oe.g8,refetchPredictions:()=>{i.invalidateQueries([ne.ac.DumbPositionList])},usePredictionDataByFiled:g,usePredictionInitialed:y,usePredictions:p,usePricePrecision:s.fV,useAssetPrecision:s.RK,useCurrentPrice:te,predictionPairs:e}},ae=e=>e.map((e=>{const i={positionHash:e.positionHash,pair:e.pair.replace("/",""),pairBase:e.pairBase,marginToken:e.marginToken,isLong:e.isLong,hash:e.positionHash,entryPrice:(0,o.mb)(e.entryPrice.toString(),T.cB.price),qty:(0,o.mb)(e.qty.toString(),T.cB.qty),stopLoss:(0,o.mb)(e.stopLoss.toString(),T.cB.price),takeProfit:(0,o.mb)(e.takeProfit.toString(),T.cB.price),timestamp:`${e.timestamp}000`,side:e.isLong?"LONG":"SHORT",margin:e.margin.toString(),executionFee:e.executionFee.toString(),fundingFee:e.fundingFee.toString(),openFee:e.openFee.toString(),holdingFee:e.holdingFee.toString(),tokenIn:e.tokenIn};return Object.assign(Object.assign({},e),i)})).sort(((e,i)=>Number(i.timestamp)-Number(e.timestamp))),le=()=>{const e=(0,s.E4)(),{address:i,isConnected:t}=(0,Y.mA)(),o=u(),r=l((e=>e.initialPositions)),a=l((e=>e.initialPredictions)),{data:c}=(0,s.XB)({}),{data:d=[],refetch:m,isSuccess:p,isFetching:g}=(0,Y.do)(Object.assign(Object.assign({},e),{functionName:"getPositionsV2",args:[i,"0x0000000000000000000000000000000000000000"],enabled:t,cacheOnBlock:!0,cacheTime:ne.g_}));(0,n.useEffect)((()=>{t||(r([]),a([]))}),[r,a,t]),(0,n.useEffect)((()=>{p&&!o&&r(ae(d))}),[d,r,p,o]),(0,n.useEffect)((()=>{o&&!g&&r(ae(d))}),[d,r,g,o]),(0,n.useEffect)((()=>(U.ee.on("REFETCH_POSITION_LIST",m),()=>{U.ee.off("REFETCH_POSITION_LIST",m)})),[m]),(0,n.useEffect)((()=>{c&&c.success&&a(c.data)}),[a,c])},ce=e=>{const{close:i}=(0,s.Le)(e);return(0,n.useMemo)((()=>i),[i])};var de=t(48042);const ue=()=>(0,n.useMemo)((()=>({addMargin:({hash:e,amount:i,closeModalCallBack:t,marginToken:n})=>(0,H.__awaiter)(void 0,void 0,void 0,(function*(){j.emit("ADD_MARGIN",{hash:e,amount:i,closeModalCallBack:t,marginToken:n})}))})),[]),me=e=>{const{getI18n:i}=(0,q.V6)(),t=m(e,"qty"),o=m(e,"isLong"),a=m(e,"entryPrice"),l=m(e,"pair"),{index:c}=f(e),d=_(e),{fundingFee:u}=B(e),p=(0,s.fV)(l),{marginToken:g,margin:y,qtyPrecision:h}=v(e),P=(0,n.useCallback)((e=>new r.Z(y).plus(e)),[y]),b=(0,n.useCallback)((e=>new r.Z(t).multipliedBy(a).dividedBy(new r.Z(e).multipliedBy(c))),[a,c,t]),N=(0,n.useCallback)((e=>{const i=new r.Z(e).multipliedBy(d).multipliedBy(c).plus(u).dividedBy(t);return o?new r.Z(a).minus(i):new r.Z(a).plus(i)}),[a,u,c,o,d,t]);return(0,n.useMemo)((()=>({symbol:l,side:o?i("userinfo-positions-side-LONG","Long"):i("userinfo-positions-side-SHORT","Short"),isLong:o,marginToken:g,marginQtyPrecision:h,pricePrecision:p,formatNumber:L.uf,calcMargin:P,calcLeverage:b,calcLiqPrice:N,useTokenApprove:de.Z,useContractAddMargin:ue})),[l,o,i,g,h,p,P,b,N])};var pe=t(46970);const ge=e=>{const i=m(e,"timestamp"),{getI18n:t}=(0,q.V6)();return(0,n.useMemo)((()=>(0,L.jE)(Number(i),t)),[i,t])},ye=e=>{const{executionFee:i}=M(e),{executionFee:t}=B(e),{symbol:s,qtyPrecision:o}=v(e);return(0,n.useMemo)((()=>`${(0,L.FL)(new r.Z(i),o)} ${s} ( ≈ ${(0,L.uf)(t,2)} USD )`),[i,o,s,t])},ve=e=>{const i=(0,b.h)(),{fundingFee:t,holdingFee:s}=M(e),{fundingFee:o,holdingFee:a}=B(e),{symbol:l,qtyPrecision:c}=v(e);return(0,n.useMemo)((()=>{const e=new r.Z(t).minus(s);return{fundingFee:`${e.isNegative()?"":"+"}${(0,L.FL)(e,c)} ${i[l]||l} ( ≈ ${(0,L.uf)(new r.Z(o).minus(a),2)} USD )`,isFundingFeeNegative:e.isNegative()}}),[t,s,c,l,o,a,i])},fe=e=>{const i=(0,b.h)(),{symbol:t,qtyPrecision:s}=v(e),o=(e=>{const{margin:i}=v(e);return(0,n.useMemo)((()=>i),[i])})(e),{margin:r}=O(e);return(0,n.useMemo)((()=>`${(0,L.FL)(o,s)} ${i[t]||t} ( ≈ ${(0,L.uf)(r,1)} USD )`),[o,s,t,r,i])},he=e=>{const{PNL:i}=x(e),{openFee:t,executionFee:n}=M(e);return i.minus(t).minus(n)},Pe=e=>{const i=(0,b.h)(),{symbol:t,qtyPrecision:s}=v(e),o=he(e),r=(e=>{const i=he(e),{index:t}=f(e);return i.multipliedBy(t)})(e);return(0,n.useMemo)((()=>({netProfit:o.isNaN()?"-":`${o.isNegative()?"":"+"}${(0,L.FL)(o,s)} ${i[t]||t} ( ≈ ${(0,L.uf)(r,1)} USD )`,isNetProfitNegative:o.isNegative()})),[o,s,t,r,i])},be=e=>{const i=(0,b.h)(),{openFee:t}=M(e),{openFee:s}=B(e),{symbol:o,qtyPrecision:a}=v(e);return(0,n.useMemo)((()=>`${(0,L.FL)(new r.Z(t),a)} ${i[o]||o} ( ≈ ${(0,L.uf)(s,2)} USD )`),[t,a,o,s,i])},Le=e=>{const i=m(e,"pair"),t=(0,h.Lh)(i,"baseAsset");return(0,n.useMemo)((()=>({pair:i,baseAsset:t})),[i,t])},Ne=e=>{const i=(0,b.h)(),{symbol:t,qtyPrecision:s}=v(e),{index:o}=f(e),{PNL:r,ROI:a}=x(e);return(0,n.useMemo)((()=>{const e=(0,L.FL)(r,s),n=`${(0,L.uf)(a.multipliedBy(100),2)}%`,l=r.isFinite(),c=a.isFinite(),d=r.isNegative(),u=r.gt(0),m=a.isNegative(),p=i[t]||t;return{PNL:l?`${d?"":"+"}${e} ${p} ( ≈ ${(0,L.uf)(r.multipliedBy(o),1)} USD\n      )`:"-",PNLOrigin:r,PNLFormatted:e,ROI:c?m?n:`+${n}`:"-",isPNLNegative:d,isPNLPositive:u,isROINegative:m,marginSymbol:p}}),[r,a,s,o,t,i])},Ee=e=>{const i=C(e),t=m(e,"qty"),s=m(e,"pair"),o=(0,h.Lh)(s,"quantityPrecision");return(0,n.useMemo)((()=>({size:i,qty:(0,L.uf)(t,o)})),[t,o,i])},Oe=()=>{const{track:e}=(0,pe.B)(),i=(0,n.useCallback)((i=>{e(i?"pv_degen_position_detail_popup":"pv_classic_position_detail_popup")}),[e]);return(0,n.useMemo)((()=>({usePositionDetailPair:Le,usePositionDetailLeverage:F,usePositionDetailInitialMargin:fe,usePositionDetailSymbol:k,usePositionDetailQtyAndSize:Ee,usePositionDetailFundingFee:ve,usePositionDetailOpenFee:be,usePositionDetailExecutionFee:ye,usePositionDetailEntryPrice:E,usePositionDetailLiquidPrice:D,usePositionDetailLiqLostRate:_,usePositionDetailPNLROI:Ne,usePositionDetailNetProfit:Pe,usePositionDetailDuration:ge,usePositionDetailPricePrecision:s.fV,onPositionDetailOpen:i,useIsDegenMode:J})),[i])};var we=t(59629);const Fe=e=>{const i=(0,b.h)(),t=m(e,"qty"),a=m(e,"entryPrice"),l=m(e,"side"),c=m(e,"pair"),d=m(e,"takeProfit"),u=m(e,"stopLoss"),p=(0,s.fV)(c),g=w(e),{fundingFee:y}=B(e),{data:h}=(0,s.VT)(),P=_(e),{index:N}=f(e),{qtyPrecision:E,symbol:O}=v(e),F=(0,n.useMemo)((()=>"LONG"===l),[l]),M=(0,n.useMemo)((()=>E),[E]),D=(0,n.useMemo)((()=>2),[]),S=(0,n.useMemo)((()=>F?(null==h?void 0:h.maxTakeProfitP)?(0,o.mb)(h.maxTakeProfitP,T.cB.percent):"Infinity":(null==h?void 0:h.maxTakeProfitP)?r.Z.minimum(new r.Z(g),(0,o.mb)(h.maxTakeProfitP,T.cB.percent)).toString():"Infinity"),[F,g,null==h?void 0:h.maxTakeProfitP]),x=(0,we.D)((e=>F?new r.Z(e).multipliedBy(N).minus(y).dividedBy(t).plus(a):new r.Z(a).minus(new r.Z(e).multipliedBy(N).minus(y).dividedBy(t)))),I=(0,we.D)((e=>F?new r.Z(e).minus(a).multipliedBy(t).plus(y).dividedBy(N):new r.Z(a).minus(e).multipliedBy(t).plus(y).dividedBy(N))),C=(0,we.D)((e=>new r.Z(t).multipliedBy(a).multipliedBy(e).dividedBy(g).dividedBy(N))),k=(0,we.D)((e=>new r.Z(e).multipliedBy(N).multipliedBy(g).dividedBy(new r.Z(t).multipliedBy(a)))),Z=(0,we.D)((e=>F?new r.Z(e).multipliedBy(N).minus(y).dividedBy(t).plus(a):new r.Z(a).minus(new r.Z(e).multipliedBy(N).minus(y).dividedBy(t)))),H=(0,we.D)((e=>F?new r.Z(e).minus(a).multipliedBy(t).plus(y).dividedBy(N):new r.Z(a).minus(e).multipliedBy(t).plus(y).dividedBy(N))),R=(0,we.D)((e=>new r.Z(t).multipliedBy(a).multipliedBy(e).dividedBy(g).dividedBy(N))),A=(0,we.D)((e=>new r.Z(e).multipliedBy(N).multipliedBy(g).dividedBy(new r.Z(t).multipliedBy(a)))),$=(0,we.D)((e=>`${(0,L.uf)(e,M)} ${i[O]||O}`)),q=(0,we.D)((e=>(0,L.uf)(e,D))),U=(0,we.D)((e=>(0,L.uf)(e,p)));return(0,n.useMemo)((()=>({getTakeProfitPrice:x,getTakeProfitPNL:I,getTakeProfitPNLByROI:C,getTakeProfitROI:k,getStopLossPrice:Z,getStopLossPNL:H,getStopLossPNLByROI:R,getStopLossROI:A,pair:c,takeProfit:d,stopLoss:u,pricePrecision:p,PNLPrecision:M,ROIPrecision:D,maxTakeProfitROI:S,minStopLossROI:(-P).toString(),side:l,entryPrice:a,formatPNL:$,formatROI:q,formatPrice:U,useContractUpdateTPSL:ie})),[M,D,a,$,U,q,H,R,Z,A,I,C,x,k,S,P,c,p,l,u,d])}},58921:(e,i,t)=>{"use strict";t.d(i,{T:()=>n});const n={positions:"positions",orders:"orders",history:"history"}}}]);